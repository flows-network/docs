"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[392],{3905:(e,t,o)=>{o.d(t,{Zo:()=>c,kt:()=>p});var r=o(7294);function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function s(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?s(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):s(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function a(e,t){if(null==e)return{};var o,r,n=function(e,t){if(null==e)return{};var o,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)o=s[r],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)o=s[r],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var l=r.createContext({}),u=function(e){var t=r.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},c=function(e){var t=u(e.components);return r.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var o=e.components,n=e.mdxType,s=e.originalType,l=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),h=u(o),p=n,m=h["".concat(l,".").concat(p)]||h[p]||d[p]||s;return o?r.createElement(m,i(i({ref:t},c),{},{components:o})):r.createElement(m,i({ref:t},c))}));function p(e,t){var o=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=o.length,i=new Array(s);i[0]=h;var a={};for(var l in t)hasOwnProperty.call(t,l)&&(a[l]=t[l]);a.originalType=e,a.mdxType="string"==typeof e?e:n,i[1]=a;for(var u=2;u<s;u++)i[u]=o[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,o)}h.displayName="MDXCreateElement"},1663:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>s,metadata:()=>a,toc:()=>u});var r=o(7462),n=(o(7294),o(3905));const s={sidebar_position:1},i="Customize your GitHub PR Review workflow to save time and reduce errors",a={unversionedId:"cookbook/github/pr-review-bot",id:"cookbook/github/pr-review-bot",title:"Customize your GitHub PR Review workflow to save time and reduce errors",description:"A Pull Request (PR) makes it easy for software developers to collaborate and discuss proposed changes to the code base. When a developer or contributor wants to make a change to the source code, s/he would open a PR that contains all proposed changes. The project\u2019s code owners (or maintainers for open source projects) would then review the PR, discuss it in a message board, request changes, and decide if it can be merged into the code base.",source:"@site/docs/cookbook/github/pr-review-bot.md",sourceDirName:"cookbook/github",slug:"/cookbook/github/pr-review-bot",permalink:"/docs/cookbook/github/pr-review-bot",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/cookbook/github/pr-review-bot.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"GitHub automation cookbook",permalink:"/docs/category/github-automation-cookbook"},next:{title:"Reduce alert fatigue through GitHub notification triage",permalink:"/docs/cookbook/github/github-notification"}},l={},u=[{value:"The use case",id:"the-use-case",level:3},{value:"The solution",id:"the-solution",level:3},{value:"<strong>Next steps</strong>",id:"next-steps",level:3}],c={toc:u};function d(e){let{components:t,...s}=e;return(0,n.kt)("wrapper",(0,r.Z)({},c,s,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"customize-your-github-pr-review-workflow-to-save-time-and-reduce-errors"},"Customize your GitHub PR Review workflow to save time and reduce errors"),(0,n.kt)("p",null,"A Pull Request (PR) makes it easy for software developers to collaborate and discuss proposed changes to the code base. When a developer or contributor wants to make a change to the source code, s/he would open a PR that contains all proposed changes. The project\u2019s code owners (or maintainers for open source projects) would then review the PR, discuss it in a message board, request changes, and decide if it can be merged into the code base."),(0,n.kt)("p",null,"Since code owners, reviewers, and fellow developers spend so much on reviewing PRs, most teams have rules to make sure that PRs follow certain formats or content guidelines. Such structured PRs can be reviewed quickly and are less error prone than free form PRs."),(0,n.kt)("p",null,"GitHub bots can automate the PR review workflow and improve the team\u2019s productivity and code quality. However, the traditional approach to create a GitHub bot requires developers to set up a webhook server and to interact with the GitHub web API directly (eg to explicitly authenticate every request)."),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://flows.network/"},"Flows.network")," provides a serverless platform for developers to create github bots. You can simply upload the PR review logic in a function. In this tutorial, I will give a concrete example in Rust. "),(0,n.kt)("h3",{id:"the-use-case"},"The use case"),(0,n.kt)("p",null,"A software development team uses GitHub for code repository and JIRA for issue tracking. One of its rules for PR review is that the PR title must include a corresponding JIRA ID. "),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"An JIRA ID has a distinct alpha-numeric pattern. It starts with three letters followed by a sequential number starting from 1. There is a dash between the letters and numbers. For example, FLO-123 is a well formed JIRA ID.")),(0,n.kt)("h3",{id:"the-solution"},"The solution"),(0,n.kt)("p",null,"We can create a flow function on flows.network. It is triggered by a Github PR event, and then sends its responses back to the PR. "),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"I assumed that you have basic knowledge of the concepts of the flows.network. If not, please check out ",(0,n.kt)("a",{parentName:"p",href:"/docs/category/getting-started"},"Getting Started"),"  first.")),(0,n.kt)("p",null,"We select GitHub as the inbound connector and authenticate it's access to flows.network. It is triggered by \u201cactivity related to pull requests\u201d. The following figure shows how to configure the inbound connector on flows.network. "),(0,n.kt)("p",null,(0,n.kt)("img",{src:o(785).Z,width:"804",height:"438"})),(0,n.kt)("p",null,"The outbound connector is GitHub as well. The action is to create a comment and/or assign the PR to a reviewer. The following figure shows how to configure the outbound connector."),(0,n.kt)("p",null,(0,n.kt)("img",{src:o(6661).Z,width:"806",height:"422"})," "),(0,n.kt)("p",null,"Next, upload the Rust serverless function to check if the PR title includes a valid JIRA ID. ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/second-state/flow-functions/tree/main/github/github/check-jira-id/rust"},"The complete code")," is on GitHub. It uses regular expressions to match the pattern for valid JIRA IDs. "),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"The Rust code needs to be complied to Wasm file before uploading. Refer to ",(0,n.kt)("a",{parentName:"p",href:"https://docs.flows.network/docs/getting-started/rust/understand-the-flow-function-in-rust"},"this article")," for more details.")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'// The PR title should be three letters-numbers description.\n let re = Regex::new(r"^[A-Za-z]{3}-\\d+").unwrap();\n// If the PR title doesn\'t match the rule, then send a message to the PR creator to update the PR title\n if !re.is_match(title) {\n  bodies.push(String::from(\n    "This PR\'s title doesn\'t match our requirement.",\n  ));\n  bodies.push(String::from("Please make sure your title includes the corresponding Jira id."));\n  bodies.push(format!(\n    "@{}, please update it.",\n    pull_request["user"]["login"].as_str().unwrap()\n  ));\n// If the title meets the requirement, send a welcome message to the PR creator and assign this PR to the reviewer\n } else {\n  bodies.push(String::from("Welcome"));\n  assignees.insert("jetjinser");\n };\n')),(0,n.kt)("p",null,"Finally, click on the enable button to start listening for events and webhook calls from the inbound connector (ie Github PR events). "),(0,n.kt)("p",null,"That's it. The figure below shows how the complete flow works. The reviewer is assigned if the PR title contains a valid JIRA ID."),(0,n.kt)("p",null,(0,n.kt)("img",{src:o(127).Z,width:"1166",height:"439"})),(0,n.kt)("h3",{id:"next-steps"},(0,n.kt)("strong",{parentName:"h3"},"Next steps")),(0,n.kt)("p",null,"The above example only shows a simple use case. Since the flow function on flows.network can make web services requests, you can do a lot more by writing code!"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Look up the issue on JIRA and make sure that the GitHub PR description matches the JIRA issue title."),(0,n.kt)("li",{parentName:"ul"},"Automatically assign labels based on keywords in the PR title. "),(0,n.kt)("li",{parentName:"ul"},"When the PR is merged, the corresponding issues in JIRA would be closed."),(0,n.kt)("li",{parentName:"ul"},"If the PR receives three LGTMs from maintainers, then merge this PR automatically"),(0,n.kt)("li",{parentName:"ul"},"When the PR is merged, invite the PR author to join the contributors' slack channel. (The outbound connector would be Slack instead of GitHub in this case)"),(0,n.kt)("li",{parentName:"ul"},"and many more ")),(0,n.kt)("p",null,"We will add more examples soon. Stay tuned. If you have ideas to share with us, don't hesitate to let us know by filling in ",(0,n.kt)("a",{parentName:"p",href:"https://forms.gle/2V7RvpUK4BGQrBUZ6"},"this form"),"."))}d.isMDXComponent=!0},785:(e,t,o)=>{o.d(t,{Z:()=>r});const r=o.p+"assets/images/pr-review-bot-inbound-99190113b44d8cf8e1452d545d7a7062.jpg"},6661:(e,t,o)=>{o.d(t,{Z:()=>r});const r=o.p+"assets/images/pr-review-bot-outbound-5f82a210588971f275a4bc45dcedc4f9.jpg"},127:(e,t,o)=>{o.d(t,{Z:()=>r});const r=o.p+"assets/images/pr-review-bot-outcome-7a6f7d920c120ec66528911be560e307.jpg"}}]);